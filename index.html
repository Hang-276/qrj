<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è‡´æˆ‘æ°¸æ’çš„çˆ±äºº</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@500;700&display=swap" rel="stylesheet">

    <style>
        /* --- å“¥ç‰¹ç¾å­¦å…¨å±€å®šä¹‰ --- */
        :root {
            --primary-gold: #d4af37; 
            --primary-red: #720e1e;  
            --bg-dark: #0f0508;      
            --text-light: #e0e0e0;
            --font-title: 'Noto Serif SC', serif; 
            --font-body: 'Noto Serif SC', serif;    
            --font-sign: 'Ma Shan Zheng', cursive; 
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background-color: var(--bg-dark);
            background-image: 
                radial-gradient(circle at 50% 30%, #3b0910 0%, #0f0508 70%),
                url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23d4af37' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            color: var(--text-light);
            font-family: var(--font-body);
            overflow: hidden; user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- è£…é¥°è¾¹æ¡† --- */
        .ornament-border {
            position: fixed; top: 12px; left: 12px; right: 12px; bottom: 12px;
            border: 2px solid rgba(212, 175, 55, 0.25); pointer-events: none; z-index: 100;
            box-shadow: inset 0 0 20px rgba(114, 14, 30, 0.2);
        }
        .ornament-border::before, .ornament-border::after {
            content: 'âœ¥'; position: absolute; color: var(--primary-gold); font-size: 24px;
            text-shadow: 0 0 5px rgba(212, 175, 55, 0.5);
        }
        .ornament-border::before { top: -14px; left: 50%; transform: translateX(-50%); }
        .ornament-border::after { bottom: -16px; left: 50%; transform: translateX(-50%); }

        /* --- é¡µé¢æ§åˆ¶ --- */
        .page {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; align-items: center;
            opacity: 0; pointer-events: none; transition: opacity 1.5s cubic-bezier(0.4, 0.0, 0.2, 1);
            z-index: 1; overflow-y: auto; padding: 40px 0; box-sizing: border-box;
        }
        .page.center-content { justify-content: center; overflow: hidden; }
        .page.active { opacity: 1; pointer-events: all; z-index: 10; }

        /* --- Module New: å†™åœ¨æœ€å (æš—å¤œé•¿å·) --- */
        .final-scroll-box {
            width: 85%;
            max-width: 650px;
            height: 50vh; /* å æ®å±å¹•é«˜åº¦ */
            background: rgba(15, 5, 8, 0.85); /* æ·±è‰²åŠé€æ˜èƒŒæ™¯ */
            border: 1px solid var(--primary-gold); /* é‡‘è‰²ç»†è¾¹æ¡† */
            padding: 25px;
            box-sizing: border-box;
            overflow-y: auto; /* å…è®¸å‚ç›´æ»šåŠ¨ */
            margin-bottom: 30px;
            position: relative;
            box-shadow: 0 0 20px rgba(0,0,0,0.8), inset 0 0 50px rgba(0,0,0,0.8);
            text-align: justify;
            /* é€‚é…ç§»åŠ¨ç«¯æ»šåŠ¨ä½“éªŒ */
            -webkit-overflow-scrolling: touch;
        }

        /* å“¥ç‰¹é£æ ¼æ»šåŠ¨æ¡ç¾åŒ– */
        .final-scroll-box::-webkit-scrollbar { width: 6px; }
        .final-scroll-box::-webkit-scrollbar-track { background: #0f0508; border-left: 1px solid #333; }
        .final-scroll-box::-webkit-scrollbar-thumb { background: var(--primary-red); border-radius: 3px; box-shadow: 0 0 5px rgba(114, 14, 30, 0.8); }

        .final-text-content {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #dcdcdc; /* é“¶ç°è‰²æ–‡å­— */
            white-space: pre-wrap; /* ä¿ç•™æ¢è¡Œå’Œç©ºæ ¼ */
            letter-spacing: 1.5px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.8);
        }
        
        .title-divider {
            width: 100px; height: 2px;
            background: linear-gradient(90deg, transparent, var(--primary-gold), transparent);
            margin: 10px auto 20px auto;
        }

        /* --- æŒ‰é’® --- */
        .gothic-btn {
            background: linear-gradient(to bottom, #2b0a10, #1a0608);
            color: var(--primary-gold); border: 1px solid var(--primary-gold);
            padding: 18px 45px; font-family: var(--font-title); font-weight: 700;
            font-size: 1.3rem; letter-spacing: 4px; cursor: pointer; position: relative;
            transition: all 0.5s ease; margin-top: 20px; margin-bottom: 20px;
            box-shadow: 0 0 0 3px #0f0508, 0 0 0 5px rgba(212, 175, 55, 0.4), 0 10px 20px rgba(0,0,0,0.5);
            text-shadow: 0 2px 2px rgba(0,0,0,0.8);
            z-index: 20;
        }
        .gothic-btn::after {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: linear-gradient(to bottom right, rgba(255,255,255,0) 20%, rgba(212, 175, 55, 0.1) 50%, rgba(255,255,255,0) 80%);
            transform: rotate(45deg); transition: all 0.5s linear; opacity: 0; pointer-events: none;
        }
        .gothic-btn:hover {
            color: #fff; background: var(--primary-red);
            box-shadow: 0 0 0 3px #0f0508, 0 0 0 6px rgba(212, 175, 55, 0.8), 0 0 30px rgba(114, 14, 30, 0.8);
        }
        .gothic-btn:hover::after { opacity: 1; transform: rotate(45deg) translate(50%, 50%); }

        /* --- è§†é¢‘åœ†çª— --- */
        .video-frame {
            position: relative; width: 260px; height: 260px;
            border-radius: 50%; overflow: hidden; border: 3px solid var(--primary-gold);
            box-shadow: 0 0 0 8px rgba(114, 14, 30, 0.3), 0 0 40px rgba(114, 14, 30, 0.6), inset 0 0 20px rgba(0,0,0,0.8);
            animation: frameFloat 6s ease-in-out infinite; background: #000;
        }
        .video-frame video { width: 100%; height: 100%; object-fit: cover; transform: scale(1.05); }
        @keyframes frameFloat { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-12px); } }

        /* --- ç›¸æ¡†æ ·å¼ --- */
        .gallery-frame {
            padding: 12px; border: 4px groove var(--primary-gold); background: #1a0b0f;
            margin-bottom: 20px; position: relative; width: 80%; max-width: 500px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.8);
        }
        .gallery-frame img { 
            width: 100%; display: block; filter: saturate(80%) contrast(110%); 
        }
        .photo-text { margin-top: 20px; color: var(--primary-gold); text-align: center; font-size: 1.2rem; text-shadow: 0 2px 2px black; letter-spacing: 2px; }

        h1.gothic-title {
            font-family: var(--font-title); font-weight: 700; font-size: 3rem; margin-top: 50px;
            background: linear-gradient(to bottom, #f0e6d2, #d4af37, #8a6e18);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 5px rgba(0,0,0,0.8); letter-spacing: 5px;
        }

        /* --- Module 1: æ„¿æœ›æ¸…å•æ ·å¼ --- */
        .wish-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            overflow: hidden; pointer-events: none;
            padding: 50px; box-sizing: border-box; 
        }
        .main-wish-text {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 1.8rem; color: var(--primary-gold); font-weight: 700;
            text-shadow: 0 0 15px rgba(212, 175, 55, 0.8); z-index: 20;
            text-align: center; border-bottom: 2px solid var(--primary-red); padding-bottom: 10px;
            background: rgba(15, 5, 8, 0.85); 
            border-radius: 10px; padding: 15px 30px;
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
            width: auto; max-width: 80%;
        }
        
        .floating-wish {
            position: absolute; 
            white-space: nowrap; 
            opacity: 0; 
            transition: opacity 1s ease-in;
            animation: wishFloat 10s ease-in-out infinite alternate;
            font-family: 'Noto Serif SC', serif;
        }
        
        @keyframes wishFloat {
            0% { transform: translateY(0) translateX(0); }
            100% { transform: translateY(-15px) translateX(10px); }
        }

        /* æŒ‰é’®å®šä½ */
        #btnWishNext {
            position: absolute; bottom: 10%; left: 50%; transform: translateX(-50%);
            z-index: 50; 
        }

        /* --- Module 2: çƒ›å…‰/æ˜Ÿè¾°äº’åŠ¨æ ·å¼ --- */
        .candle-container {
            position: relative; width: 100%; height: 50vh; display: flex;
            justify-content: center; align-items: center; flex-direction: column;
        }
        .candle-flame {
            width: 30px; height: 30px; background: #ff9900;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            box-shadow: 0 0 20px #ff9900, 0 0 40px #ff4d6d;
            animation: flicker 1s infinite alternate;
            cursor: pointer; transition: all 1s ease;
        }
        .candle-flame:hover { transform: scale(1.2); }
        
        .candle-text {
            margin-top: 40px; font-size: 1.2rem; color: #555; opacity: 0; transition: opacity 2s;
            text-align: center; letter-spacing: 3px;
        }
        
        .lit-up .candle-flame {
            transform: scale(30); opacity: 0;
        }
        .lit-up-bg {
            animation: lightExplosion 2s forwards;
        }
        @keyframes flicker {
            0% { transform: scale(1); opacity: 0.8; }
            100% { transform: scale(1.1); opacity: 1; }
        }
        @keyframes lightExplosion {
            0% { background-color: var(--bg-dark); }
            50% { background-color: #4a1218; }
            100% { background-color: var(--bg-dark); }
        }

        /* --- æ¸¸æˆ & å…¶ä»–é€šç”¨ --- */
        .heart-emoji {
            position: absolute; font-size: 2.8rem; cursor: pointer;
            filter: drop-shadow(0 0 8px rgba(114, 14, 30, 0.8));
            animation: floatUpSlow linear forwards; transition: transform 0.2s;
        }
        .heart-emoji:active { transform: scale(1.3); filter: drop-shadow(0 0 15px var(--primary-red)); }

        .quote-toast {
            position: absolute; top: 45%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(15, 5, 8, 0.95); border: 2px solid var(--primary-gold);
            color: var(--primary-gold); padding: 20px 30px; font-weight: 700; font-size: 1.3rem;
            pointer-events: none; opacity: 0; text-align: center; width: auto; min-width: 60%;
            z-index: 100; box-shadow: 0 10px 30px rgba(0,0,0,0.9); animation: fadeToast 3s ease-in-out forwards;
        }
        @keyframes fadeToast {
            0% { opacity: 0; transform: translate(-50%, -35%); }
            15% { opacity: 1; transform: translate(-50%, -50%); }
            85% { opacity: 1; transform: translate(-50%, -50%); }
            100% { opacity: 0; transform: translate(-50%, -65%); }
        }
        @keyframes floatUpSlow {
            0% { transform: translateY(110vh) scale(0.8) rotate(0deg); opacity: 0; }
            10% { opacity: 0.9; }
            100% { transform: translateY(-10vh) scale(1) rotate(20deg); opacity: 0.9; }
        }

        .parchment {
            width: 85%; max-width: 600px; background: #c2a878;
            padding: 45px; box-shadow: 0 20px 60px rgba(0,0,0,0.9); margin: auto 0;
            clip-path: polygon(2% 5%, 98% 2%, 100% 96%, 95% 99%, 5% 98%, 1% 94%);
            border: 5px solid rgba(114, 14, 30, 0.2); position: relative;
        }
        .parchment-content {
            font-size: 1.25rem; line-height: 2; border: 3px double #720e1e; padding: 25px; color: #3b0910;
        }
        .signature-font { font-family: var(--font-sign); font-size: 2rem; margin-top: 10px; display: inline-block; transform: rotate(-2deg); color: #720e1e; }
        #particles { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; }
    </style>
</head>
<body>

    <div class="ornament-border"></div>
    <canvas id="particles"></canvas>
    
    <audio id="bgMusic" loop preload="auto">
        <source src="assets/bgm.mp3" type="audio/mpeg">
    </audio>

    <div class="page active center-content" id="page1">
        <div class="video-frame">
            <video autoplay muted playsinline loop>
                <source src="assets/rose_bloom.mp4" type="video/mp4">
            </video>
        </div>
        <h1 class="gothic-title">çˆ±æ„æ°¸æ’</h1>
        <p style="color: #a89078; font-size: 1.1rem; margin-top:10px; margin-bottom: 50px; letter-spacing: 2px;">ä»¥æ˜Ÿè¾°ä¸ºå¢¨ï¼Œä¹¦å†™ä¸æœ½ç¯‡ç« </p>
        <button class="gothic-btn" onclick="startJourney()">å¼€å¯æ—…ç¨‹ Â· Enter</button>
    </div>

    <div class="page center-content" id="page2">
        <h2 style="font-size: 2.5rem; margin-bottom: 30px; color: var(--primary-gold); letter-spacing: 5px;">åˆè§æƒŠé¸¿ï¼Œä¸€çœ¼ä¸‡å¹´</h2>
        <div class="gallery-frame">
            <img src="assets/memory.jpg" alt="Our Memory">
            <div class="photo-text">æˆ‘ä¼šæ¯«ä¸çŠ¹è±«çš„å¥”å‘ä½ ï¼Œè¿™æ¬¡ï¼Œæ¯æ¬¡ï¼Œæ¬¡æ¬¡</div>
        </div>
        <button class="gothic-btn" onclick="nextPage(2)">ç»§ç»­å‰è¡Œ Â· Proceed</button>
    </div>

    <div class="page" id="page_wishlist">
        <div class="wish-container" id="wishContainer">
        </div>
        <div class="main-wish-text" id="mainWishTitle">æˆ‘æƒ³å’Œä½ ä¸€èµ·åšå¾ˆå¤šäº‹......</div>
        <button class="gothic-btn" id="btnWishNext" onclick="nextPage('wishlist')">ç»§ç»­å‰è¡Œ Â· Proceed</button>
    </div>

    <div class="page center-content" id="page_lightup">
        <h2 style="font-size: 2rem; color: #aaa; margin-bottom: 50px; text-align: center;">é»‘å¤œæ¼«é•¿ï¼Œå”¯ä½ é—ªè€€</h2>
        
        <div class="candle-container" id="candleContainer" onclick="lightUpCandle()">
            <div class="candle-flame"></div>
            <div class="candle-text" id="candleText">ç‚¹å‡»çƒ›å…‰ï¼Œç‚¹äº®æœªæ¥</div>
        </div>
        
        <button class="gothic-btn" id="btnToGame" style="display: none; margin-top: 50px;" onclick="nextPage('lightup')">æ”¶é›†çˆ±æ„ Â· Collect</button>
    </div>

    <div class="page center-content" id="page3">
        <h2 style="font-size: 2.2rem; z-index: 20; color: var(--text-light);">æ”¶é›† 6 é¢—çˆ±å¿ƒ</h2>
        <div style="color: var(--primary-gold); font-size: 1.8rem; z-index: 20; border-bottom: 2px solid var(--primary-gold); padding-bottom: 10px; margin-top: 20px;">
            <span id="score">0</span> / 6
        </div>
        <div id="gameArea" style="position: absolute; width:100%; height:100%; z-index:10;"></div>
    </div>

    <div class="page" id="page4">
        <div class="parchment">
            <div class="parchment-content" id="typewriterText"></div>
            <div style="text-align: right; margin-top: 30px;">
                <div style="font-size: 1.2rem; color: #720e1e;">æ°¸è¿œçˆ±ä½ çš„ï¼Œ</div>
                <div class="signature-font" id="myName">XXX</div>
            </div>
        </div>
        <button class="gothic-btn" onclick="nextPage(4)">è¿˜æœ‰å‡ å¥è¯ Â· Next</button>
    </div>

    <div class="page center-content" id="page5">
        <h1 class="gothic-title" style="margin-top: 0; font-size: 2.5rem;">å†™åœ¨æœ€å</h1>
        <div class="title-divider"></div>
        
        <div class="final-scroll-box">
            <div class="final-text-content">
è™½ç„¶ä¸å¤ªåº”è¯¥åœ¨è¿™é‡Œå‡ºç°è¿™æ ·çš„è¯
ä½†æ˜¯æˆ‘è¿˜æ˜¯æƒ³è¯´
å› ä¸ºæˆ‘ä¸æ„¿æ„æŠŠä½ å¼„å¾—æ„ŸåŠ¨äº†æœ€åå´æ— ç–¾è€Œç»ˆ
è¿™ä¸ªç½‘é¡µæ˜¯å¥½å‡ å¤©ä¹‹å‰åšå¥½çš„
ä½†æ˜¯è¿‘å‡ å¤©æˆ‘å¤šäº†ä¸€äº›æ–°çš„æƒ³æ³•å§

æˆ‘çœŸçš„å¾ˆå–œæ¬¢ä½ ï¼Œå¾ˆå–œæ¬¢å¾ˆå–œæ¬¢
ä½†æ˜¯æ²¡æœ‰ä»€ä¹ˆæƒ…æ„Ÿæ˜¯ä¼šæ°¸è¿œç‚½çƒ­çš„
çš„ç¡®å¥½åƒè¿‡äº†é‚£æ®µæ‰€è°“â€œçƒ­æ‹â€çš„æ—¶æœŸäº†
åœ¨è¿™ç§æ—¶æœŸç»´æŒä¸€æ®µæ„Ÿæƒ…çš„ä¸å†æ˜¯ä¸€è…”çƒ­è¡€
æ˜¯ç›¸å¤„ä¸­çš„ä¸€åˆ‡æ­£åé¦ˆ
ä¹Ÿæ˜¯åšæŒï¼Œä»¥åŠå¯¹æœªæ¥ç¾å¥½çš„å¹»æƒ³
å½“ç„¶ç°åœ¨æˆ‘ä»¬çš„å…³ç³»åªæ˜¯æœ‹å‹
è¿™åªèƒ½ç®—æ˜¯æˆ‘çš„è‡ªå¨±è‡ªä¹ç½¢äº†

åƒä½ å½“åˆä¸€æ ·ï¼Œæˆ‘çš„ç†æ™ºå¥½åƒå æ®äº†è¶Šæ¥è¶Šé«˜çš„ä½ç½®
æˆ‘ä¹Ÿå¼€å§‹æ€è€ƒäº†å¾ˆå¤šé—®é¢˜
æœ‰ä¸€ä»¶äº‹æˆ‘æœ€è¿‘ä¸€ç›´æƒ³è¦å’Œä½ äº¤æµä¸€ä¸‹å¯æ˜¯ä¹Ÿæ²¡ä»€ä¹ˆåˆé€‚çš„æœºä¼š
åªèƒ½åœ¨ç°åœ¨å‘ä½ è¡¨è¾¾

æˆ‘æƒ³è¦çŸ¥é“çš„æ˜¯å¯¹äºå¼‚åœ°æˆ–è€…è¯´éš¾ä»¥è§é¢çš„æƒ…ä¾£ç»´ç³»æ„Ÿæƒ…çš„ä½ çš„æƒ³æ³•æ˜¯ä»€ä¹ˆ
å¦ç™½è¯´æˆ‘ä¹Ÿä¸æ¸…æ¥š
æˆ‘çš„æœ‹å‹å¾ˆå¤šéƒ½æ˜¯æœ‰äº†æƒ…æ„ŸåŸºç¡€ä¹‹åå› ä¸ºæ¯•ä¸šæˆ–æ˜¯å·¥ä½œçš„åŸå› è€Œå¼‚åœ°
å¯¹äºè¿™ç§å¼€å§‹å°±éš¾ä»¥è§é¢çš„æƒ…å†µæˆ‘ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæˆç†Ÿçš„ç»éªŒ
ä½†æ˜¯æˆ‘çš„æƒ³æ³•æ˜¯
æˆ‘æ˜¯ä¸€ä¸ªç®—æ˜¯æ‹çˆ±è„‘çš„äººï¼Œä¸€ä¸ªä¸æŸæ‹‰å›¾çš„äºº
æˆ‘ä¼šæŠŠæ„Ÿæƒ…è¿™ä»¶äº‹æ‘†åœ¨ä¸€ä¸ªå¾ˆé«˜çš„ä½ç½®
å‡ ä¹æ²¡ä»€ä¹ˆèƒ½æ¯”å…¶æ›´é‡è¦
å½“ç„¶ï¼Œè¿™ä¸æ„å‘³ç€æˆ‘è¦æ±‚å¦ä¸€åŠä¹Ÿè¦ç½®æ„Ÿæƒ…äºåŒæ ·çš„ä½ç½®
ä½†æ˜¯è‡³å°‘åº”è¯¥å¯¹è¿™ä»¶å°‘æœ‰çš„è´¯ç©¿äººç”Ÿçš„äº‹ç»™äºˆç›¸å½“çš„é‡è§†

æˆ‘æƒ³è¦äº†è§£çš„æ— å…³ä¹å½“ä¸‹
è¿™å¹¶ä¸æ˜¯çŸ­æ—¶é—´çš„ä»·å€¼æ’åºè€Œæ˜¯äººç”Ÿçš„ä»·å€¼æ’åº
ä¸€æ®µæ—¶æœŸå†…ï¼Œå°±åƒè€ƒç ”ã€æ‰¾å·¥ä½œã€æˆ–è€…å¿ƒæƒ…ä¸å¥½ç­‰ç­‰
æŸä¸€æ®µæ—¶æœŸå†…æ— è®ºæ€ä¹ˆå¯¹å¾…æ„Ÿæƒ…æˆ‘éƒ½å¯ä»¥æ¥å—
ä½†æˆ‘ä¸å¸Œæœ›æ°¸è¿œæ˜¯è¿™ç§å¾ˆæ·¡çš„çŠ¶æ€
æ‰€ä»¥æˆ‘æƒ³è¦çŸ¥é“çš„æ˜¯æ‹‰é•¿å°ºåº¦åœ¨æ•´ä¸ªç”Ÿæ´»ä¸­ä½ æ˜¯ä»€ä¹ˆæ ·çš„æ€åº¦

ä½ æˆ‘éƒ½æ˜¯æƒ³è¦ä¸€æ®µé•¿ä¹…çš„æ‹çˆ±çš„äºº
å¯¹äºè¿™æ ·ä¸€æ®µç°å®ä¸­æœ‰äº›åå·æœ‰è®¸å¤šé˜»ç¢çš„æ‹çˆ±
æˆ‘æƒ³æ˜¯éœ€è¦æ ¼å¤–çš„ç”¨å¿ƒå»å‘µæŠ¤çš„

ä½†æ˜¯æˆ‘ä¹Ÿä¸å¸Œæœ›ä½ æ”¹å˜ä½ æ‰€æƒ³è¦çš„çŠ¶æ€
å¦ç™½è¯´æˆ‘è§‰å¾—ä½ çš„ç»å†å·²ç»æ²¡é‚£ä¹ˆå¹¸ç¦
ä¸å¸Œæœ›ä½ å†è¿‡å¤šçš„å§”æ›²æ±‚å…¨
æ‰€ä»¥æˆ‘æƒ³è¦çŸ¥é“ä½ çœŸæ­£çš„æƒ³æ³•æ˜¯ä»€ä¹ˆ

è¯šç„¶ï¼Œæˆ‘çŸ¥é“ä½ æ˜¯ä¸€ä¸ªå¾ˆçœ‹é‡çˆ±çš„äºº
ä½†æ˜¯å…·è±¡åŒ–çš„è¯´
åœ¨æˆ‘ä»¬çš„ç›¸å¤„ä¹‹ä¸­
æˆ‘æ²¡æœ‰å¤ªçœ‹å‡ºä½ çš„æƒ³æ³•æ˜¯ä»€ä¹ˆ
æˆ‘ä¹Ÿä¸å¸Œæœ›ç»™ä½ å¸¦æ¥ä¼¤å®³å¸¦æ¥ç—›è‹¦
æ‰€ä»¥å³ä¾¿æœ‰äº›å†’æ˜§ä¹Ÿæƒ³è¦è·Ÿä½ äº¤æµ
            </div>
        </div>
        
        <button class="gothic-btn" onclick="location.reload()">é‡æ¸©ç¾å¥½ Â· Replay</button>
    </div>

    <script>
        // --- ğŸ”´ é…ç½®åŒºåŸŸ ---
        const myName = "Hang"; 
        document.getElementById('myName').innerText = myName;

        const loveLetter = `Dear å®‡é‘«ï¼š

æƒ…äººèŠ‚å¿«ä¹ã€‚

åœ¨è¿™æµ©ç€šå®‡å®™çš„æ— å°½é•¿å¤œä¸­ï¼Œ
ä½ æ˜¯æˆ‘å”¯ä¸€çš„å…‰ã€‚
é©±æ•£é»‘æš—ï¼Œç…§äº®æˆ‘çš„æ•´ä¸ªä¸–ç•Œã€‚
æˆ‘çš„æ¯ä¸€æ¬¡å¿ƒè·³éƒ½ä¸ºä½ è€ŒåŠ¨ï¼Œ
æ— è®ºé£æš´è‚†è™ï¼Œè¿˜æ˜¯ä¸‡ç±ä¿±å¯‚ã€‚
æˆ‘è¿ˆå‡ºçš„æ¯ä¸€æ­¥éƒ½æŒ‡å‘ä½ ã€‚

è‡³æ­»ä¸æ¸ã€‚`;

        const sweetQuotes = [
            "çˆ±ä½ èƒœäºæ˜¨æ—¥ï¼Œç•¥åŒ®æ˜æœã€‚",
            "åƒäº‘è¿½ç€é£ï¼Œä¸é—®æ‰€èµ·ï¼›åƒé›¨è´´ç€åœ°ï¼Œæƒ…ä¸è‡ªç¦ã€‚",
            "æˆ‘å°†ç«ç‘°è—äºèº«åï¼Œæ—¶åˆ»æœŸç›¼ä¸ä½ èµ´çº¦ã€‚",
            "ç«ç‘°ç»ˆä¼šæ¯èï¼Œæµªæ¼«è‡³æ­»ä¸æ¸ã€‚",
            "æµ·æ°´æœ‰å°½å¤´ï¼Œæœˆäº®æœ‰åœ†ç¼ºï¼Œäººé—´æœ‰ä¸è¶³ï¼Œä½†æœ‰ä½ åœ¨ï¼Œå°±èƒ½å¼¥è¡¥ã€‚",
            "ä¸ºä½ ï¼Œåƒåƒä¸‡ä¸‡éã€‚"
        ];

        const wishListItems = [
            "æƒ³å’Œä½ å»ä¼¦æ•¦çœ‹æ³°æ™¤å£«æ²³ä¸Šçš„æ—¥å‡º", "æƒ³å’Œä½ å»å–å¡çº³æ²³è¾¹çš„å’–å•¡", "æƒ³å’Œä½ å»å†°å²›çœ‹æå…‰", "æƒ³å’Œä½ å…»ä¸€åªè¨æ‘©è€¶",
            "æƒ³å’Œä½ æ‰‹ç‰µæ‰‹é€›è¶…å¸‚", "æƒ³å’Œä½ åœ¨é›¨å¤©çªåœ¨æ²™å‘çœ‹ç”µå½±", "æƒ³å’Œä½ å»è¿ªå£«å°¼çœ‹çƒŸèŠ±", "æƒ³å’Œä½ æ‹å¾ˆå¤šå¾ˆå¤šåˆç…§",
            "æƒ³å’Œä½ åœ¨å½¼æ­¤é¢å‰æ¯«æ— å½¢è±¡çš„å¤§ç¬‘", "æƒ³å’Œä½ ä¸€èµ·å»çœ‹ä¸€åœºæ¼”å”±ä¼š", "æƒ³å’Œä½ åƒéå…¨å›½å„åœ°çš„ç¾é£Ÿ",
            "æƒ³å’Œä½ æ¯å¹´ä¸€èµ·è¿‡ç”Ÿæ—¥", "æƒ³å’Œä½ å»æµ·è¾¹çœ‹æ—¥è½", "æƒ³å’Œä½ ä¸€èµ·æ‹¼ä¸€ä¸ªå·¨å¤§çš„ä¹é«˜", "æƒ³å’Œä½ ç©¿ç€ç¡è¡£å»ä¾¿åˆ©åº—",
            "æƒ³å’Œä½ äº’ç›¸å¹å¤´å‘", "æƒ³å’Œä½ ä¸€èµ·çœ‹åŒ—äº¬çš„åˆé›ª", "æƒ³å’Œä½ å»æˆéƒ½çœ‹å¤§ç†ŠçŒ«", "æƒ³å’Œä½ åœ¨æ‘©å¤©è½®æœ€é«˜å¤„æ‹¥æŠ±",
            "æƒ³å’Œä½ ä¸€èµ·å»å¯ºåº™ç¥ˆç¦", "æƒ³å’Œä½ ä¸€èµ·å»è¥¿æ¹–è¾¹éª‘è¡Œ", "æƒ³å’Œä½ ä¸€èµ·å¸ƒç½®æˆ‘ä»¬çš„å®¶", "æƒ³å’Œä½ ä¸€èµ·å¬æ­Œ",
            "æƒ³å’Œä½ ä¸€èµ·å»æ»‘é›ª", "æƒ³å’Œä½ åœ¨æ— äººçš„è¡—é“æ•£æ­¥", "æƒ³å’Œä½ ä¸€èµ·çœ‹ææ€–ç‰‡ç„¶åæŠ±åœ¨ä¸€èµ·", "æƒ³å’Œä½ å»è¥¿è—çœ‹å¸ƒè¾¾æ‹‰å®«",
            "æƒ³å’Œä½ ä¸€èµ·å‡è‚¥", "æƒ³å’Œä½ æ¢æƒ…ä¾£å¤´åƒ", "æƒ³å’Œä½ ä¸€èµ·å˜è€", "æƒ³è¦ä¸‹è¾ˆå­è¿˜è¦é‡è§ä½ ",
            "æƒ³æ¯å¤©é†’æ¥ç¬¬ä¸€çœ¼éƒ½æ˜¯ä½ ", "æƒ³ç»™ä½ äº²æ‰‹åšä¸€é¡¿å¤§é¤", "æƒ³åœ¨å†¬å¤©æŠŠæ‰‹æ”¾è¿›ä½ çš„å£è¢‹",
            "æƒ³å’Œä½ æ’‘ä¸€æŠŠä¼åœ¨é›¨ä¸­æ¼«æ­¥","æƒ³å’Œä½ ä¸€èµ·åƒå¾ˆå¤šé¡¿é¥­","åœ¨å˜ˆæ‚å–§é—¹çš„äººç¾¤ä¸­å¯¹è§†",
            "æƒ³å’Œä½ ä¸€èµ·èµ°åœ¨å‚æ™šçš„è¡—é“ä¸Šçœ‹å¤•é˜³æŠŠå½±å­æ‹‰çš„å¾ˆé•¿é•¿åˆ°ä»¿ä½›èƒ½èµ°åˆ°æ—¶é—´çš„å°½å¤´",
            "æƒ³å¬ä½ è®²çç¢çš„æ—¥å¸¸","æƒ³å’Œä½ ä¸€èµ·çœ‹çƒŸèŠ±","æƒ³å’Œä½ ä¸€èµ·é€›è¡—","æƒ³å’Œä½ å»KTV",
            "æƒ³å’Œä½ ç©¿åŒæ¬¾è¡£æœ","æƒ³å’Œä½ ä¸€èµ·å»æµ·æ´‹é¦†","æƒ³å’Œä½ ä¸€èµ·éœ²è¥","æƒ³å’Œä½ ä¸€èµ·è¿½å‰§","æƒ³å’Œä½ ä¸€èµ·ç§èŠ±èŠ±è‰è‰"
        ];

        // --- é€»è¾‘ä»£ç  ---
        let score = 0;
        const targetScore = 6;
        let gameInterval;
        let quoteIndex = 0;

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            document.getElementById(pageId).scrollTop = 0;
        }

        function nextPage(current) {
            if (current === 2) {
                showPage('page_wishlist');
                setTimeout(initWishList, 800);
            } else if (current === 'wishlist') {
                showPage('page_lightup');
                setTimeout(() => {
                    document.getElementById('candleText').style.opacity = 1;
                }, 1000);
            } else if (current === 'lightup') {
                showPage('page3');
                setTimeout(startGame, 800);
            } else if (current === 3) {
                showPage('page4');
                setTimeout(startTypewriter, 800);
            } else if (current === 4) {
                // ğŸ”´ æ–°å¢ï¼šä»ä¿¡çº¸é¡µè·³è½¬åˆ°â€œå†™åœ¨æœ€åâ€é¡µ
                showPage('page5');
            }
        }

        function startJourney() {
            const audio = document.getElementById('bgMusic');
            if (audio) {
                audio.play().catch(e => console.log("æ’­æ”¾å¤±è´¥...", e));
            }
            showPage('page2');
        }

        // --- Module 1: æ„¿æœ›æ¸…å•é€»è¾‘ ---
        function initWishList() {
            const container = document.getElementById('wishContainer');
            container.innerHTML = ''; 

            const containerWidth = container.clientWidth;
            const containerHeight = container.clientHeight;
            const padding = 20; 

            const mainTitle = document.getElementById('mainWishTitle');
            const titleRect = mainTitle.getBoundingClientRect();
            const safeMargin = 20;
            const titleSafeBox = {
                left: titleRect.left - safeMargin,
                right: titleRect.right + safeMargin,
                top: titleRect.top - safeMargin,
                bottom: titleRect.bottom + safeMargin
            };

            const btn = document.getElementById('btnWishNext');
            const btnRect = btn.getBoundingClientRect();
            const btnSafeBox = {
                left: btnRect.left - safeMargin,
                right: btnRect.right + safeMargin,
                top: btnRect.top - safeMargin, 
                bottom: containerHeight 
            };

            const shuffledWishes = wishListItems.sort(() => 0.5 - Math.random()).slice(0, 32);
            let index = 0;

            const interval = setInterval(() => {
                if (index >= shuffledWishes.length) {
                    clearInterval(interval);
                    return;
                }

                const text = shuffledWishes[index];
                const el = document.createElement('div');
                el.classList.add('floating-wish');
                el.innerText = text;

                const depth = Math.random(); 
                let targetOpacity = 1;
                let zIndex = 1;

                if (depth > 0.7) {
                    el.style.fontSize = (Math.random() * 0.4 + 1.2) + 'rem';
                    targetOpacity = 0.95;
                    zIndex = 5;
                } else if (depth > 0.4) {
                    el.style.fontSize = (Math.random() * 0.3 + 0.9) + 'rem';
                    targetOpacity = 0.7;
                    zIndex = 3;
                } else {
                    el.style.fontSize = (Math.random() * 0.2 + 0.7) + 'rem';
                    targetOpacity = 0.4;
                    zIndex = 1;
                }
                
                el.style.zIndex = zIndex;
                const colors = ['#d4af37', '#e0e0e0'];
                el.style.color = colors[Math.floor(Math.random() * colors.length)];

                el.style.visibility = 'hidden';
                container.appendChild(el);
                
                const w = el.offsetWidth;
                const h = el.offsetHeight;

                const maxX = containerWidth - w - padding;
                const maxY = containerHeight - h - padding;
                
                let x, y;
                let validPosition = false;
                let attempts = 0;

                while (!validPosition && attempts < 50) {
                    x = padding + Math.random() * (maxX - padding);
                    y = padding + Math.random() * (maxY - padding);

                    const textRect = {
                        left: x,
                        right: x + w,
                        top: y,
                        bottom: y + h
                    };

                    const hitsTitle = !(textRect.right < titleSafeBox.left || 
                                      textRect.left > titleSafeBox.right || 
                                      textRect.bottom < titleSafeBox.top || 
                                      textRect.top > titleSafeBox.bottom);

                    const hitsButton = !(textRect.right < btnSafeBox.left || 
                                       textRect.left > btnSafeBox.right || 
                                       textRect.bottom < btnSafeBox.top || 
                                       textRect.top > btnSafeBox.bottom);

                    if (!hitsTitle && !hitsButton) {
                        validPosition = true;
                    }
                    attempts++;
                }

                if (!validPosition) {
                      y = padding + Math.random() * (titleSafeBox.top - h - padding * 2);
                      x = padding + Math.random() * (maxX - padding);
                }

                el.style.left = x + 'px';
                el.style.top = y + 'px';
                el.style.visibility = 'visible';
                
                requestAnimationFrame(() => {
                    el.style.opacity = targetOpacity;
                });

                index++;
            }, 100); 
        }

        function lightUpCandle() {
            const container = document.getElementById('candleContainer');
            const btn = document.getElementById('btnToGame');
            const text = document.getElementById('candleText');
            
            container.classList.add('lit-up');
            document.getElementById('page_lightup').classList.add('lit-up-bg');
            
            text.innerText = "æƒ…ä¸çŸ¥æ‰€èµ·ï¼Œä¸€å¾€è€Œæƒ…æ·±";
            text.style.color = "#d4af37";
            text.style.fontSize = "1.5rem";
            text.style.textShadow = "0 0 10px #d4af37";
            
            setTimeout(() => {
                btn.style.display = 'block';
                btn.animate([
                    { opacity: 0, transform: 'translateY(20px)' },
                    { opacity: 1, transform: 'translateY(0)' }
                ], { duration: 1000, fill: 'forwards' });
            }, 1000);
        }

        function startGame() {
            const gameArea = document.getElementById('gameArea');
            const scoreEl = document.getElementById('score');
            score = 0;
            scoreEl.innerText = score;
            quoteIndex = 0;

            gameInterval = setInterval(() => {
                if (score >= targetScore) { clearInterval(gameInterval); return; }
                createHeart();
            }, 1400);

            function createHeart() {
                const el = document.createElement('div');
                el.classList.add('heart-emoji');
                el.innerText = 'â¤ï¸'; 
                el.style.left = (Math.random() * 70 + 15) + '%';
                const duration = Math.random() * 5 + 10; 
                el.style.animationDuration = duration + 's';

                el.onclick = (e) => {
                    if(el.clicked) return;
                    el.clicked = true;
                    score++;
                    scoreEl.innerText = score;
                    el.style.opacity = 0;
                    el.style.transform = 'scale(2) rotate(45deg)';
                    setTimeout(() => el.remove(), 300);
                    showQuote();

                    if (score >= targetScore) {
                        clearInterval(gameInterval);
                        document.querySelectorAll('.heart-emoji').forEach(h => h.style.opacity = 0);
                        setTimeout(() => nextPage(3), 3500);
                    }
                };
                gameArea.appendChild(el);
                setTimeout(() => { if(el.parentNode) el.remove(); }, duration * 1000);
            }
        }

        function showQuote() {
            const quote = sweetQuotes[quoteIndex];
            quoteIndex = (quoteIndex + 1) % sweetQuotes.length;
            const toast = document.createElement('div');
            toast.classList.add('quote-toast');
            toast.innerText = quote;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        function startTypewriter() {
            const el = document.getElementById('typewriterText');
            el.innerHTML = '';
            let i = 0;
            function type() {
                if (i < loveLetter.length) {
                    el.innerHTML += loveLetter.charAt(i) === '\n' ? '<br>' : loveLetter.charAt(i);
                    i++;
                    setTimeout(type, 120);
                }
            }
            type();
        }

        const canvas = document.getElementById('particles');
        const ctx = canvas.getContext('2d');
        let particles = [];
        function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.addEventListener('resize', resize); resize();

        class Particle {
            constructor() { this.reset(); }
            reset() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.size = Math.random() * 2.5 + 0.5;
                this.speedY = Math.random() * -0.4 - 0.1; 
                this.alpha = Math.random() * 0.4 + 0.1;
                this.color = Math.random() > 0.8 ? '#720e1e' : '#d4af37';
            }
            update() {
                this.y += this.speedY; this.alpha -= 0.001;
                if (this.y < 0 || this.alpha <= 0) this.reset();
            }
            draw() {
                ctx.globalAlpha = this.alpha; ctx.fillStyle = this.color;
                ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fill();
            }
        }
        for(let i=0; i<80; i++) particles.push(new Particle());
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach(p => { p.update(); p.draw(); });
            requestAnimationFrame(animate);
        }
        animate();
    </script>
</body>
</html>
